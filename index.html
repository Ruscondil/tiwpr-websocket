<!DOCTYPE html>
<html>

<head>
    <title>Room Creator</title>
</head>

<body>
    <h1>Room Creator</h1>
    <input id="roomName" type="text" placeholder="Enter room name">
    <button id="createRoom">Create Room</button>
    <h2>Rooms</h2>
    <ul id="roomList"></ul>

    <script>
        var socket = new WebSocket("ws://localhost:8765");
        var roomList = document.getElementById('roomList');
        var startGameButton = document.createElement('button');
        startGameButton.textContent = 'Start Game';
        startGameButton.style.display = 'none';  // Hide the button initially
        startGameButton.addEventListener('click', function () {
            socket.send(JSON.stringify({ action: 'start_game' }));
        });
        document.body.appendChild(startGameButton);

        document.getElementById('createRoom').addEventListener('click', function () {
            var roomName = document.getElementById('roomName').value;
            socket.send(JSON.stringify({ action: 'create_room', room_name: roomName }));
        });

        socket.onmessage = function (event) {
            var data = JSON.parse(event.data);
            if (data.action === 'start_game') {  // If the server sends a start_game action
                startGameButton.style.display = 'block';  // Show the Start Game button
            } else if (data.message === 'Waiting for start of the game') {  // If the server sends a waiting message
                roomList.innerHTML = 'Waiting for start of the game';  // Display the waiting message
            } else if (data.message === 'Room info') {
                var roomList = document.getElementById('roomList');
                roomList.innerHTML = '';
                for (var room in data.rooms) {
                    var listItem = document.createElement('li');
                    listItem.textContent = room + ': ' + data.rooms[room] + ' players';

                    var joinButton = document.createElement('button');
                    joinButton.textContent = 'Join';
                    joinButton.addEventListener('click', function () {
                        socket.send(JSON.stringify({ action: 'join_room', room_name: room }));
                    });

                    listItem.appendChild(joinButton);
                    roomList.appendChild(listItem);
                }
            }
        };

        socket.onopen = function (event) {
            socket.send(JSON.stringify({ action: 'get_rooms' }));
        };
    </script>
</body>

</html>